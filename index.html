<!DOCTYPE html>
<html>
<head>
    <title>HWP.js Test</title>
    <meta charset="UTF-8">
</head>
<body>
    <div id="hwp-container"></div>
    
    <!-- 스크립트 로드 확인 -->
    <script>
        // 스크립트 로드 함수
        function loadScript(url, callback) {
            const script = document.createElement('script');
            script.type = 'text/javascript';
            script.src = url;
            script.onload = callback;
            script.onerror = function() {
                console.error('스크립트 로드 실패: ' + url);
            };
            document.head.appendChild(script);
        }
        
        // 라이브러리 로드 시도
        loadScript('https://cdn.jsdelivr.net/npm/hwp.js/dist/hwp.js', function() {
            console.log('hwp.js 스크립트 로드 완료');
            init();
        });
        
        // 다른 버전 시도
        function tryAlternative() {
            console.log('대체 버전 시도 중...');
            loadScript('https://cdn.jsdelivr.net/npm/@hwpjs/hwp.js/dist/hwp.js', function() {
                console.log('@hwpjs/hwp.js 스크립트 로드 완료');
                init();
            });
        }
        
        // 초기화 함수
        function init() {
            const container = document.getElementById('hwp-container');
            
            if (window.HWP || typeof HWP !== 'undefined') {
                console.log('HWP 객체 발견: ', HWP);
                
                try {
                    HWP.open(
                        'test.hwp',
                        container,
                        {
                            type: 'array-buffer'
                        }
                    )
                    .then(function() {
                        console.log('HWP 파일 로드 완료');
                    })
                    .catch(function(error) {
                        console.error('HWP 파일 로드 실패:', error);
                        container.innerText = 'HWP 파일 로드에 실패했습니다: ' + error.message;
                    });
                } catch (e) {
                    console.error('HWP 초기화 오류:', e);
                    container.innerText = 'HWP 초기화 오류: ' + e.message;
                }
            } else {
                console.error('HWP 객체를 찾을 수 없습니다.');
                container.innerText = 'HWP 라이브러리가 정상적으로 로드되지 않았습니다.';
                
                // 대체 버전 시도
                if (!window.triedAlternative) {
                    window.triedAlternative = true;
                    tryAlternative();
                }
            }
        }
    </script>
</body>
</html>
